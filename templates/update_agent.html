<!-- ==========================================
File: update_agent.html
Created in iteration: 1
Author: Karl Concha

#ChatGPT (OpenAI, 2025) – Assisted in refining Bootstrap table layout 
and Jinja2 loop logic for displaying editable stage records. 
Conversation Topic: "Rainn Iteration 1 – Update agent and stage form in Flask template"
Date: November 2025

References:
- Bootstrap 5 Documentation: https://getbootstrap.com/docs/5.3/content/tables/
- Flask Jinja2 Templating Guide: https://flask.palletsprojects.com/
- UCC IS4470 FYP Bible – Iteration documentation and code referencing requirements

Notes:
This template provides the front-end interface for updating agent details 
and viewing or editing linked stage records. It completes the Update portion 
of the CRUD cycle for Iteration 1 and directly connects with the 
`update_agent` and `update_stage` Flask routes.
========================================== -->

{% extends "base.html" %}
{% block content %}
<div class="container mt-5" style="max-width: 750px;">
  <div class="card shadow-lg border-0">
    <div class="card-header text-white text-center" style="background-color: #7F6A93;">
      <h4 class="mb-0">Edit Agent & Stages</h4>
    </div>
    <div class="card-body" style="background-color: #E8EEF2;">

      <!-- Agent form -->
      <form method="POST" action="{{ url_for('update_agent', agent_id=agent.TaskDef_ID) }}">
        <div class="mb-3">
          <label class="form-label fw-bold">Agent Name</label>
          <input type="text" class="form-control" name="agent_name" value="{{ agent.TaskDef_Name }}" required>
        </div>
        <div class="mb-3">
          <label class="form-label fw-bold">Agent Description</label>
          <textarea class="form-control" name="agent_description" rows="3" required>{{ agent.TaskDef_Description }}</textarea>
        </div>

        <div class="text-end mb-4">
          <button type="submit" class="btn text-white" style="background-color:#7F6A93;">Save Agent</button>
        </div>
      </form>

      <hr>

      <!-- Stage list -->
      <h5 class="fw-bold text-center mb-3">Linked Stages</h5>

      <table class="table table-striped table-bordered align-middle">
        <thead class="table-dark">
          <tr>
            <th>ID</th>
            <th>Stage Type</th>
            <th>Description</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for stage in stages %}
          <tr>
            <td>{{ stage.TaskStageDef_ID }}</td>
            <td>{{ stage.TaskStageDef_Type }}</td>
            <td>{{ stage.TaskStageDef_Description }}</td>
            <td>
              <a href="{{ url_for('update_stage', stage_id=stage.TaskStageDef_ID) }}"
                 class="btn btn-sm btn-outline-primary">
                <i class="bi bi-pencil"></i> Edit
              </a>
            </td>
          </tr>
          {% else %}
          <tr><td colspan="4" class="text-center text-muted">No stages found.</td></tr>
          {% endfor %}
        </tbody>
      </table>

      <div class="d-flex justify-content-between">
        <a href="{{ url_for('get_all_agents_and_stages') }}" class="btn btn-outline-secondary">Back</a>
      </div>

    </div>
  </div>
</div>
{% endblock %}
