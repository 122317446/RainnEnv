{% extends "base.html" %}

{% block content %}

<div class="container mt-4">

    <h3>Step 1: Provide Input for Your Agent</h3>
    <p class="text-muted">Upload files, enter instructions, or specify a folder your agent should scan.</p>

    <form method="POST" enctype="multipart/form-data">

        <!-- TEXT INPUT -->
        <div class="mb-3">
            <label class="form-label fw-bold">Instruction Text</label>
            <textarea name="text_input" class="form-control" rows="4"></textarea>
        </div>

        <!-- FILE UPLOAD -->
        <div class="mb-3">
            <label class="form-label fw-bold">Upload File</label>
            <input type="file" name="uploaded_file" class="form-control">
        </div>

        <!-- DIRECTORY PATH -->
        <div class="mb-3">
            <label class="form-label fw-bold">Directory Path (Optional)</label>
            <input type="text" 
                   name="directory_path" 
                   class="form-control" 
                   placeholder="/Users/Karl/Documents/Invoices/">
        </div>

        <!-- OPERATION SELECTION -->
        <div class="mb-3">
            <label class="form-label fw-bold">Select Operation (TaskDef)</label>
            <select name="operation_selected" class="form-control" onchange="this.form.submit()">
                <option value="">-- Select an operation --</option>
                {% for op in task_defs %}
                    <option value="{{ op.TaskDef_ID }}" {% if selected_taskdef and selected_taskdef == op.TaskDef_ID %}selected{% endif %}>
                        {{ op.TaskDef_Name }}
                    </option>
                {% endfor %}
            </select>
        </div>

        {% if stages %}
        <h5 class="mt-4">Pipeline Stages:</h5>
        <ul>
            {% for s in stages %}
            <li><strong>{{ s.TaskStageDef_Type }}</strong>: {{ s.TaskStageDef_Description }}</li>
            {% endfor %}
        </ul>
        {% endif %}


        <!-- SUBMIT -->
        <button type="submit" class="btn btn-primary">
            Save Input
        </button>

    </form>

</div>

{% endblock %}
